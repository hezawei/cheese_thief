---
name: add-feature
description: 新功能开发时遵循项目架构，同时检查旧代码是否需要清理重构
---

# 新功能开发

开发新功能不只是写新代码，还要确保新代码融入现有架构，同时检查有没有旧代码需要清理。

## 项目架构

后端是 Flask，分两层：
- routes 目录放路由，只管接收请求和返回响应，不写业务逻辑
- services 目录放业务逻辑，处理具体的事情

前端是 Vue3：
- components 放可复用的组件
- views 放页面
- api 放后端接口调用
- stores 放状态管理

## 开发流程

先搜一下项目里有没有类似的功能，看看别人怎么写的，保持风格一致。

然后按分层来写：
- 后端先写 service 处理业务逻辑
- 再写 route 暴露接口
- 前端先写 api 封装调用
- 再写组件或页面

## 写完新代码后要检查

新功能写完后，回头看一下：
- 有没有旧代码和新代码功能重复了，重复的要合并或删掉
- 文件名是不是准确描述了内容，不准确就改名
- 文件放的位置对不对，放错了就挪
- 有没有可以抽成公共函数的逻辑
- 代码量是不是太多了，太多就拆分

## 不要这样做

不要在 routes 里写业务逻辑，那是 services 的事。
不要在 services 里处理 HTTP 请求响应，那是 routes 的事。
不要建新目录，除非现有目录真的放不下。
不要复制粘贴大段代码，重复的逻辑要提取出来。
