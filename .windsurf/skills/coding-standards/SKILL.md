---
name: coding-standards
description: 代码编写规范，涵盖质量、安全和风格
---

# 代码编写规范

写代码的核心原则：简洁、好读、好改、安全。

## 一、代码质量

### 1.1 简洁

- 用最少的代码把事情做完
- 重复代码提取为公共函数
- 没用的导入、变量、函数直接删掉
- 别过度抽象，搞得太绕反而不好

### 1.2 好读

- 变量和函数名能看出来干什么
- 复杂逻辑加一句注释说明意图
- 函数超过 50 行就考虑拆分

### 1.3 好改

- 一个函数只干一件事
- 配置不写死，放到配置文件
- 依赖通过参数传进来

## 二、安全编辑

### 2.1 禁止使用 PowerShell 修改文件内容

Windows PowerShell 默认使用 GBK 编码，会导致 UTF-8 文件中的中文损坏。

```
[安全] Move-Item 移动目录
[安全] Remove-Item 删除目录
[禁止] Set-Content 写入文件
[禁止] Get-Content | Set-Content 管道操作
```

### 2.2 正确的修改方式

```
[推荐] 使用 IDE 的 edit 或 multi_edit 工具
[推荐] 每次修改后验证 app 是否正常导入
[推荐] 小批量修改，每次 3-5 个文件
[推荐] 需要批量替换时，写 Python 脚本
```

### 2.3 验证步骤

每次修改后必须验证：

```bash
python -c "from app import app; print('[OK] app import successful')"
```

## 三、风格规范

### 3.1 禁止使用 Emoji 和特殊符号

写代码时：
- 禁止在注释、日志、字符串中使用 emoji
- 状态用纯文本：`[OK]`、`[ERROR]`、`[INFO]`

写提示词时：
- 禁止使用 emoji 装饰
- 禁止使用特殊符号分隔线
- 禁止使用带圈数字，用普通数字

### 3.2 去 AI 化写作风格

禁止的写法：
- 过度使用标签式表达
- 堆砌形容词和副词
- 过于正式或学术的措辞

推荐的写法：
- 像和同事聊天一样自然表达
- 直接说重点，不要铺垫
- 用短句，用常见词

## 四、禁止清单

- 不要留着注释掉的代码
- 不要写死数字和字符串
- 不要让函数超过 100 行
- 不要嵌套超过三层
- 不要捕获异常后啥也不做

## 五、乱码修复

如果已经出现乱码：

1. 定位乱码文件：grep 搜索常见乱码字符
2. 从 git 恢复：`git checkout <file>`
3. 使用 edit 工具重新修改

## 六、代码目录架构
永远在实现计划等决策设计上，一定要做最优的代码目录架构设计
永远保持代码方案唯一，且干净整洁没有旧方案冗余
