# ã€Šå¥¶é…ªå¤§ç›—ã€‹åœ¨çº¿è”æœºæ¡Œæ¸¸ â€” æŠ€æœ¯è®¾è®¡æ–‡æ¡£

> **ç‰ˆæœ¬**ï¼šv1.0  
> **æ—¥æœŸ**ï¼š2026-02-19  
> **ç›®æ ‡**ï¼šåŸºäº Web æŠ€æœ¯å¼€å‘ä¸€æ¬¾å¯åœ¨ iOS Safari ä¸Šæµç•…è¿è¡Œçš„å¤šäººåœ¨çº¿è”æœºæ¡Œæ¸¸ï¼Œå®Œæ•´è¿˜åŸã€Šå¥¶é…ªå¤§ç›—ã€‹æ¡Œæ¸¸çš„æ‰€æœ‰è§„åˆ™ã€‚

---

## ä¸€ã€é¡¹ç›®æ€»è§ˆ

### 1.1 äº§å“å®šä½

- **çº¯ H5 ç½‘é¡µæ¸¸æˆ**ï¼Œæ— éœ€å®‰è£… APPï¼Œæ‰‹æœºæµè§ˆå™¨ï¼ˆSafari/Chromeï¼‰ç›´æ¥è®¿é—®
- æ”¯æŒ **PWA**ï¼ˆæ·»åŠ åˆ°ä¸»å±å¹•ï¼Œå…¨å±æ— åœ°å€æ ï¼Œä½“éªŒè¿‘ä¼¼åŸç”Ÿ APPï¼‰
- æ”¯æŒ **4ï½8 äººå®æ—¶åœ¨çº¿è”æœº**
- æœ¬åœ° Windows å¼€å‘è°ƒè¯•ï¼Œå®Œæˆåéƒ¨ç½²åˆ°è‡ªæœ‰æœåŠ¡å™¨

### 1.2 æŠ€æœ¯æ ˆæ€»è§ˆ

```
å‰ç«¯:
  â”œâ”€â”€ React 19 + TypeScript 5.8
  â”œâ”€â”€ Vite 7 (æ„å»ºå·¥å…·)
  â”œâ”€â”€ TailwindCSS 4 (CSS-first åŸå­åŒ– CSSï¼Œä½¿ç”¨ @tailwindcss/vite æ’ä»¶)
  â”œâ”€â”€ shadcn/ui (UI ç»„ä»¶åº“ï¼ŒåŸºäº Radix UIï¼ŒCLI åŒ…åä¸º shadcn)
  â”œâ”€â”€ Motion (åŠ¨ç”»å¼•æ“ï¼ŒåŸ Framer Motionï¼Œnpm åŒ…å motion)
  â”œâ”€â”€ Socket.IO Client 4.8 (å®æ—¶é€šä¿¡)
  â”œâ”€â”€ Zustand 5 (è½»é‡çŠ¶æ€ç®¡ç†)
  â””â”€â”€ PWA (vite-plugin-pwa)

åç«¯:
  â”œâ”€â”€ Node.js 22+ LTS (è¿è¡Œç¯å¢ƒï¼ŒVite 7 è¦æ±‚ Node 20.19+/22.12+)
  â”œâ”€â”€ Express.js (HTTP æœåŠ¡)
  â”œâ”€â”€ Socket.IO Server 4.8 (WebSocket å®æ—¶é€šä¿¡)
  â””â”€â”€ TypeScript 5.8

å…±äº«:
  â””â”€â”€ shared/types.ts (å‰åç«¯å…±äº«çš„ TypeScript ç±»å‹å®šä¹‰)
```

### 1.3 é¡¹ç›®ç»“æ„

```
deskgame/
â”œâ”€â”€ client/                          # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ favicon.ico
â”‚   â”‚   â”œâ”€â”€ manifest.json            # PWA é…ç½®
â”‚   â”‚   â””â”€â”€ icons/                   # PWA å›¾æ ‡ (192x192, 512x512)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.tsx                 # å…¥å£
â”‚   â”‚   â”œâ”€â”€ App.tsx                  # è·¯ç”±æ€»æ§
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ utils.ts             # shadcn å·¥å…·å‡½æ•° (cn)
â”‚   â”‚   â”‚   â””â”€â”€ socket.ts            # Socket.IO å®¢æˆ·ç«¯å•ä¾‹
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useGameStore.ts      # Zustand æ¸¸æˆçŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ useSocket.ts         # Socket è¿æ¥ä¸äº‹ä»¶ç›‘å¬
â”‚   â”‚   â”‚   â”œâ”€â”€ useResponsive.ts     # å“åº”å¼æ–­ç‚¹ Hook
â”‚   â”‚   â”‚   â””â”€â”€ useScreenLock.ts     # å±å¹•æ–¹å‘é”å®š Hook
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                  # shadcn/ui ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ card.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dialog.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ input.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ badge.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ avatar.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ toast.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MobileContainer.tsx    # å…¨å±€ç§»åŠ¨ç«¯å®¹å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SafeAreaWrapper.tsx    # iOS å®‰å…¨åŒºåŸŸé€‚é…
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ StatusBar.tsx          # é¡¶éƒ¨çŠ¶æ€æ 
â”‚   â”‚   â”‚   â”œâ”€â”€ game/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PlayerSeat.tsx         # ç©å®¶åº§ä½ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PlayerCircle.tsx       # ç¯å½¢åº§ä½å¸ƒå±€
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DiceRoll.tsx           # éª°å­æ·éª°åŠ¨ç”»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DiceCup.tsx            # éª°ç›…ç»„ä»¶ï¼ˆå¯ç¿»çœ‹ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CheeseToken.tsx        # å¥¶é…ªæŒ‡ç¤ºç‰©
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RoleCard.tsx           # èº«ä»½å¡ï¼ˆç¿»è½¬åŠ¨ç”»ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ NightOverlay.tsx       # å¤œæ™šå…¨å±é®ç½©
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ NightAction.tsx        # å¤œæ™šè¡ŒåŠ¨é¢æ¿
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AccompliceSelect.tsx   # å…±çŠ¯æŒ‡å®šé¢æ¿
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatPanel.tsx          # ç™½å¤©è®¨è®ºèŠå¤©
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ VotePanel.tsx          # æŠ•ç¥¨é¢æ¿
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ResultScreen.tsx       # ç»“ç®—ç”»é¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Timer.tsx              # å€’è®¡æ—¶å™¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ GameLog.tsx            # æ¸¸æˆæ—¥å¿—
â”‚   â”‚   â”‚   â””â”€â”€ lobby/
â”‚   â”‚   â”‚       â”œâ”€â”€ CreateRoom.tsx         # åˆ›å»ºæˆ¿é—´
â”‚   â”‚   â”‚       â”œâ”€â”€ JoinRoom.tsx           # åŠ å…¥æˆ¿é—´
â”‚   â”‚   â”‚       â”œâ”€â”€ RoomLobby.tsx          # æˆ¿é—´ç­‰å¾…å¤§å…
â”‚   â”‚   â”‚       â””â”€â”€ PlayerList.tsx         # æˆ¿é—´å†…ç©å®¶åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ HomePage.tsx               # é¦–é¡µï¼ˆåˆ›å»º/åŠ å…¥ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ LobbyPage.tsx              # æˆ¿é—´å¤§å…é¡µ
â”‚   â”‚   â”‚   â””â”€â”€ GamePage.tsx               # æ¸¸æˆä¸»é¡µé¢
â”‚   â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â”‚   â”œâ”€â”€ globals.css                # å…¨å±€æ ·å¼ + TailwindCSS
â”‚   â”‚   â”‚   â””â”€â”€ animations.css             # è‡ªå®šä¹‰åŠ¨ç”»
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â””â”€â”€ index.ts                   # å‰ç«¯ä¸“ç”¨ç±»å‹
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ tsconfig.app.json
â”‚   â”œâ”€â”€ components.json                    # shadcn/ui é…ç½®
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ server/                          # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts                 # å…¥å£ï¼šExpress + Socket.IO å¯åŠ¨
â”‚   â”‚   â”œâ”€â”€ config.ts                # é…ç½®ï¼ˆç«¯å£ã€CORS ç­‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ socket/
â”‚   â”‚   â”‚   â”œâ”€â”€ handlers.ts          # Socket äº‹ä»¶å¤„ç†å™¨æ€»å…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ roomHandler.ts       # æˆ¿é—´ç›¸å…³äº‹ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ gameHandler.ts       # æ¸¸æˆç›¸å…³äº‹ä»¶
â”‚   â”‚   â”œâ”€â”€ game/
â”‚   â”‚   â”‚   â”œâ”€â”€ GameEngine.ts        # æ¸¸æˆå¼•æ“ï¼ˆæ ¸å¿ƒçŠ¶æ€æœºï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ GameRoom.ts          # æˆ¿é—´ç®¡ç†ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ Player.ts            # ç©å®¶ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ Dice.ts              # éª°å­é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ NightPhase.ts        # å¤œæ™šé˜¶æ®µé€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ AccomplicePhase.ts   # å…±çŠ¯é˜¶æ®µé€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ VotePhase.ts         # æŠ•ç¥¨é˜¶æ®µé€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ ResultCalculator.ts  # èƒœè´Ÿç»“ç®—
â”‚   â”‚   â”œâ”€â”€ managers/
â”‚   â”‚   â”‚   â””â”€â”€ RoomManager.ts       # å…¨å±€æˆ¿é—´ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â””â”€â”€ index.ts             # åç«¯ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ shared/                          # å‰åç«¯å…±äº«
â”‚   â”œâ”€â”€ types.ts                     # å…±äº«ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ constants.ts                 # å…±äº«å¸¸é‡
â”‚   â””â”€â”€ events.ts                    # Socket.IO äº‹ä»¶åå¸¸é‡
â”‚
â”œâ”€â”€ å¥¶é…ªå¤§ç›—_å®Œæ•´è§„åˆ™.md              # æ¸¸æˆè§„åˆ™æ–‡æ¡£
â”œâ”€â”€ æŠ€æœ¯è®¾è®¡æ–‡æ¡£.md                   # æœ¬æ–‡æ¡£
â””â”€â”€ package.json                     # monorepo æ ¹é…ç½®ï¼ˆå¯é€‰ï¼‰
```

---

## äºŒã€iOS å“åº”å¼é€‚é…æ–¹æ¡ˆï¼ˆé‡ç‚¹ï¼‰

### 2.1 ç›®æ ‡è®¾å¤‡ä¸åˆ†è¾¨ç‡

å¿…é¡»å®Œç¾é€‚é…ä»¥ä¸‹æ‰€æœ‰ iOS è®¾å¤‡ï¼š

| è®¾å¤‡ | é€»è¾‘åˆ†è¾¨ç‡ (pt) | ç‰©ç†åˆ†è¾¨ç‡ (px) | å®‰å…¨åŒºåŸŸ |
|------|-----------------|-----------------|---------|
| iPhone SE (3rd) | 375 Ã— 667 | 750 Ã— 1334 | æ— åˆ˜æµ· |
| iPhone 8 / SE2 | 375 Ã— 667 | 750 Ã— 1334 | æ— åˆ˜æµ· |
| iPhone 12 mini | 360 Ã— 780 | 1080 Ã— 2340 | åˆ˜æµ· + åº•éƒ¨æ¨ªæ¡ |
| iPhone 13 / 14 | 390 Ã— 844 | 1170 Ã— 2532 | åˆ˜æµ· + åº•éƒ¨æ¨ªæ¡ |
| iPhone 14 Pro | 393 Ã— 852 | 1179 Ã— 2556 | çµåŠ¨å²› + åº•éƒ¨æ¨ªæ¡ |
| iPhone 15 / 15 Pro | 393 Ã— 852 | 1179 Ã— 2556 | çµåŠ¨å²› + åº•éƒ¨æ¨ªæ¡ |
| iPhone 15 Plus | 430 Ã— 932 | 1290 Ã— 2796 | çµåŠ¨å²› + åº•éƒ¨æ¨ªæ¡ |
| iPhone 15 Pro Max | 430 Ã— 932 | 1290 Ã— 2796 | çµåŠ¨å²› + åº•éƒ¨æ¨ªæ¡ |
| iPhone 16 ç³»åˆ— | åŒ15ç³»åˆ— | åŒ15ç³»åˆ— | åŒ15ç³»åˆ— |
| iPad (å‚è€ƒ) | å„å°ºå¯¸ | å„å°ºå¯¸ | æŒ‰æ‰‹æœºç«–å±å¸ƒå±€å±…ä¸­ |

### 2.2 è§†å£é…ç½®

```html
<!-- index.html -->
<meta name="viewport" 
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
```

å…³é”®ç‚¹ï¼š
- `viewport-fit=cover`ï¼šè®©é¡µé¢æ‰©å±•åˆ°å®‰å…¨åŒºåŸŸä¹‹å¤–ï¼ˆåˆ˜æµ·å’Œåº•éƒ¨æ¨ªæ¡åŒºåŸŸï¼‰
- `user-scalable=no`ï¼šç¦æ­¢åŒæŒ‡ç¼©æ”¾ï¼ˆæ¸¸æˆåœºæ™¯å¿…é¡»ï¼‰
- `maximum-scale=1.0`ï¼šé˜²æ­¢ iOS Safari è‡ªåŠ¨ç¼©æ”¾
- `apple-mobile-web-app-capable=yes`ï¼šPWA å…¨å±æ¨¡å¼

### 2.3 å®‰å…¨åŒºåŸŸé€‚é…

```css
/* globals.css */

/* ä½¿ç”¨ CSS env() é€‚é… iOS å®‰å…¨åŒºåŸŸ */
:root {
  --sat: env(safe-area-inset-top, 0px);    /* é¡¶éƒ¨å®‰å…¨è·ç¦»ï¼ˆåˆ˜æµ·/çµåŠ¨å²›ï¼‰ */
  --sab: env(safe-area-inset-bottom, 0px); /* åº•éƒ¨å®‰å…¨è·ç¦»ï¼ˆæ¨ªæ¡ï¼‰ */
  --sal: env(safe-area-inset-left, 0px);   /* å·¦ä¾§å®‰å…¨è·ç¦» */
  --sar: env(safe-area-inset-right, 0px);  /* å³ä¾§å®‰å…¨è·ç¦» */
}

/* å…¨å±€å®¹å™¨ */
.game-container {
  padding-top: var(--sat);
  padding-bottom: var(--sab);
  padding-left: var(--sal);
  padding-right: var(--sar);
  min-height: 100dvh;        /* dvh = dynamic viewport heightï¼Œé€‚é… Safari åœ°å€æ  */
  height: 100dvh;
  overflow: hidden;
}
```

### 2.4 å“åº”å¼å°ºå¯¸ä½“ç³»

é‡‡ç”¨ **`dvh` + `rem` + TailwindCSS æ–­ç‚¹** ä¸‰å±‚é€‚é…ä½“ç³»ï¼š

#### ç¬¬ä¸€å±‚ï¼šåŠ¨æ€è§†å£é«˜åº¦ï¼ˆdvhï¼‰

```css
/* è§£å†³ iOS Safari åœ°å€æ å¼¹å‡º/æ”¶èµ·å¯¼è‡´é«˜åº¦å˜åŒ–çš„é—®é¢˜ */
.full-height {
  height: 100dvh; /* dynamic viewport height */
}
```

> `dvh` ä¼šéš Safari åœ°å€æ è‡ªåŠ¨è°ƒæ•´ï¼Œ`vh` ä¸ä¼šã€‚**å¿…é¡»ç”¨ dvh**ã€‚

#### ç¬¬äºŒå±‚ï¼šrem åŸºå‡†åŠ¨æ€ç¼©æ”¾

```css
/* åŸºäºå±å¹•å®½åº¦åŠ¨æ€è°ƒæ•´æ ¹å­—å·ï¼Œå®ç°æ‰€æœ‰ rem å•ä½çš„ç­‰æ¯”ç¼©æ”¾ */
html {
  /* ä»¥ 390pxï¼ˆiPhone 14ï¼‰ä¸ºåŸºå‡†è®¾è®¡ç¨¿ */
  /* 375px å±å¹•: 15.36pxï¼›390px: 16pxï¼›430px: 17.64px */
  font-size: calc(16px * (100vw / 390));
}

/* é™åˆ¶æœ€å¤§æœ€å°ï¼Œé˜²æ­¢æç«¯æƒ…å†µ */
@media (max-width: 320px) {
  html { font-size: 13.12px; }
}
@media (min-width: 500px) {
  html { font-size: 16px; } /* å¤§å±ä¸å†æ”¾å¤§ï¼Œå±…ä¸­æ˜¾ç¤º */
}
```

#### ç¬¬ä¸‰å±‚ï¼šTailwindCSS æ–­ç‚¹å¾®è°ƒ

TailwindCSS v4 ä½¿ç”¨ CSS-first é…ç½®ï¼Œæ–­ç‚¹ç›´æ¥åœ¨ CSS ä¸­é€šè¿‡ `@theme` å®šä¹‰ï¼š

```css
/* globals.css */
@import "tailwindcss";

@theme {
  --breakpoint-xs: 22.5rem;   /* 360px - iPhone 12 mini */
  --breakpoint-sm: 23.4375rem;/* 375px - iPhone SE / 8 */
  --breakpoint-md: 24.375rem; /* 390px - iPhone 13/14/15ï¼ˆåŸºå‡†ï¼‰ */
  --breakpoint-lg: 26.875rem; /* 430px - iPhone Plus / Pro Max */
  --breakpoint-xl: 48rem;     /* 768px - iPadï¼ˆå±…ä¸­çº¦æŸï¼‰ */
}
```

> TailwindCSS v4 æ–­ç‚¹å¿…é¡»ä½¿ç”¨ rem å•ä½ï¼Œä¸å†æ”¯æŒ pxã€‚

ä½¿ç”¨ç¤ºä¾‹ï¼š
```tsx
{/* ä¸åŒå±å¹•çš„å­—ä½“å’Œé—´è·å¾®è°ƒ */}
<h1 className="text-lg sm:text-xl md:text-2xl">å¥¶é…ªå¤§ç›—</h1>
<div className="p-3 sm:p-4 md:p-5">...</div>
```

### 2.5 MobileContainer å®¹å™¨ç»„ä»¶

```tsx
// æ‰€æœ‰é¡µé¢çš„æœ€å¤–å±‚å®¹å™¨
// - å¤§å±ï¼ˆiPad / PC è°ƒè¯•ï¼‰æ—¶å±…ä¸­æ˜¾ç¤ºä¸€ä¸ªæ‰‹æœºå®½åº¦çš„åŒºåŸŸ
// - æ‰‹æœºä¸Šå…¨å±
// - å¤„ç†å®‰å…¨åŒºåŸŸ
// - é”å®šç«–å±
// - ç¦æ­¢ä¸‹æ‹‰å¼¹æ€§æ»šåŠ¨

const MobileContainer = ({ children }) => (
  <div className="
    mx-auto w-full max-w-[430px]
    h-[100dvh] min-h-[100dvh]
    overflow-hidden
    bg-amber-950
    relative
    select-none touch-none
    pt-[env(safe-area-inset-top)]
    pb-[env(safe-area-inset-bottom)]
  ">
    {children}
  </div>
);
```

### 2.6 iOS ç‰¹æœ‰é—®é¢˜å¤„ç†æ¸…å•

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|---------|
| Safari åœ°å€æ å¼¹å‡º/æ”¶èµ·å¯¼è‡´å¸ƒå±€è·³åŠ¨ | ä½¿ç”¨ `100dvh` è€Œé `100vh` |
| iOS æ©¡çš®ç­‹æ»šåŠ¨ï¼ˆoverscroll bounceï¼‰ | `body { overflow: hidden; overscroll-behavior: none; }` + `touch-action: none` |
| ç‚¹å‡» 300ms å»¶è¿Ÿ | å·²è¢«ç°ä»£ Safari è‡ªåŠ¨æ¶ˆé™¤ï¼ˆ`viewport` meta å·²è®¾ç½®ï¼‰ |
| åŒæŒ‡ç¼©æ”¾ | `user-scalable=no` + `touch-action: manipulation` |
| åˆ˜æµ·/çµåŠ¨å²›é®æŒ¡ | `env(safe-area-inset-*)` padding |
| åº•éƒ¨æ¨ªæ¡ï¼ˆHome Indicatorï¼‰é®æŒ¡æŒ‰é’® | åº•éƒ¨ç•™ `pb-[env(safe-area-inset-bottom)]` æˆ–æœ€å°‘ 34px |
| PWA çŠ¶æ€æ é¢œè‰² | `<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">` |
| iOS é”®ç›˜å¼¹å‡ºæ¨é¡µé¢ | èŠå¤©è¾“å…¥æ¡†ä½¿ç”¨ `position: fixed; bottom: 0` + ç›‘å¬ `visualViewport.resize` |
| iOS Safari é•¿æŒ‰å¼¹å‡ºèœå• | `-webkit-touch-callout: none; -webkit-user-select: none;` |
| iOS å­—ä½“æ¸²æŸ“å·®å¼‚ | `-webkit-font-smoothing: antialiased;` |

### 2.7 PWA é…ç½®

```json
// public/manifest.json
{
  "name": "å¥¶é…ªå¤§ç›—",
  "short_name": "å¥¶é…ªå¤§ç›—",
  "description": "åœ¨çº¿è”æœºæ¡Œæ¸¸",
  "start_url": "/",
  "display": "standalone",
  "orientation": "portrait",
  "background_color": "#451a03",
  "theme_color": "#451a03",
  "icons": [
    { "src": "/icons/icon-192.png", "sizes": "192x192", "type": "image/png" },
    { "src": "/icons/icon-512.png", "sizes": "512x512", "type": "image/png" }
  ]
}
```

---

## ä¸‰ã€æ¸¸æˆæ ¸å¿ƒçŠ¶æ€æœºè®¾è®¡

### 3.1 æ¸¸æˆé˜¶æ®µï¼ˆGamePhaseï¼‰

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   LOBBY    â”‚ æˆ¿é—´ç­‰å¾…
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ æˆ¿ä¸»ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚  DEALING   â”‚ å‘ç‰Œ + æ·éª°
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ è‡ªåŠ¨ï¼ˆ2ç§’åŠ¨ç”»åï¼‰
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   NIGHT    â”‚ å¤œæ™šé˜¶æ®µï¼ˆ1â†’6 è½®æ¬¡ï¼‰
                    â”‚            â”‚ æ¯ä¸ªç‚¹æ•°ä¸€ä¸ªå­é˜¶æ®µ
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ 6 ç‚¹ç»“æŸå
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
           (4äººè·³è¿‡) â”‚ ACCOMPLICE â”‚ å…±çŠ¯æŒ‡å®šé˜¶æ®µï¼ˆ5-8äººï¼‰
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚    DAY     â”‚ ç™½å¤©è®¨è®ºï¼ˆæ–‡å­—èŠå¤©ï¼‰
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ ä¸»æŒäºº/å®šæ—¶å™¨è§¦å‘
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   VOTING   â”‚ æŠ•ç¥¨é˜¶æ®µ
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ æ‰€æœ‰äººæŠ•å®Œ/è¶…æ—¶
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   RESULT   â”‚ ç¿»ç‰Œ + ç»“ç®—
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ è¿”å›å¤§å…
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   LOBBY    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ ¸å¿ƒæ•°æ®æ¨¡å‹

```typescript
// shared/types.ts

// ===== æ¸¸æˆé˜¶æ®µæšä¸¾ =====
enum GamePhase {
  LOBBY = 'LOBBY',
  DEALING = 'DEALING',
  NIGHT = 'NIGHT',
  ACCOMPLICE = 'ACCOMPLICE',
  DAY = 'DAY',
  VOTING = 'VOTING',
  RESULT = 'RESULT',
}

// ===== è§’è‰²æšä¸¾ =====
enum Role {
  THIEF = 'THIEF',           // å¥¶é…ªå¤§ç›—
  SLEEPY = 'SLEEPY',         // è´ªç¡é¼ 
  SCAPEGOAT = 'SCAPEGOAT',   // èƒŒé”…é¼ 
}

// ===== é˜µè¥æšä¸¾ =====
enum Team {
  GOOD = 'GOOD',             // å¥½äººé˜µè¥ï¼ˆè´ªç¡é¼ ï¼‰
  EVIL = 'EVIL',             // åäººé˜µè¥ï¼ˆå¤§ç›— + å…±çŠ¯ï¼‰
  NEUTRAL = 'NEUTRAL',       // ç‹¬ç«‹é˜µè¥ï¼ˆèƒŒé”…é¼ ï¼‰
}

// ===== ç©å®¶æ•°æ® =====
interface Player {
  id: string;                 // Socket ID
  name: string;               // æ˜µç§°
  avatarIndex: number;        // å¤´åƒç´¢å¼•ï¼ˆé¢„è®¾å¤´åƒï¼‰
  role: Role | null;          // èº«ä»½ï¼ˆä»…æœåŠ¡ç«¯å®Œæ•´æŒæœ‰ï¼‰
  diceValue: number | null;   // éª°å­ç‚¹æ•°ï¼ˆä»…æœåŠ¡ç«¯å®Œæ•´æŒæœ‰ï¼‰
  isHost: boolean;            // æ˜¯å¦æˆ¿ä¸»
  isAccomplice: boolean;      // æ˜¯å¦å…±çŠ¯
  isConnected: boolean;       // æ˜¯å¦åœ¨çº¿
  hasVoted: boolean;          // æ˜¯å¦å·²æŠ•ç¥¨
  votedFor: string | null;    // æŠ•ç»™äº†è°çš„ ID
  voteCount: number;          // è·å¾—çš„ç¥¨æ•°
}

// ===== æˆ¿é—´æ•°æ® =====
interface GameRoom {
  roomCode: string;           // 4ä½æˆ¿é—´ç 
  players: Player[];          // ç©å®¶åˆ—è¡¨ï¼ˆæœ€å¤š8äººï¼‰
  phase: GamePhase;           // å½“å‰é˜¶æ®µ
  settings: GameSettings;     // æ¸¸æˆè®¾ç½®
  nightState: NightState;     // å¤œæ™šé˜¶æ®µçŠ¶æ€
  accompliceState: AccompliceState; // å…±çŠ¯é˜¶æ®µçŠ¶æ€
  cheeseStolen: boolean;      // å¥¶é…ªæ˜¯å¦å·²è¢«å·
  thiefId: string | null;     // å¤§ç›—ç©å®¶ ID
  accompliceIds: string[];    // å…±çŠ¯ç©å®¶ ID åˆ—è¡¨
  result: GameResult | null;  // æ¸¸æˆç»“æœ
}

// ===== æ¸¸æˆè®¾ç½® =====
interface GameSettings {
  playerCount: number;           // ç©å®¶äººæ•°
  useScapegoat: boolean;         // æ˜¯å¦ä½¿ç”¨èƒŒé”…é¼ ï¼ˆ6-8äººå¯é€‰ï¼‰
  nightActionSeconds: number;    // æ¯ä¸ªç‚¹æ•°çš„è¡ŒåŠ¨æ—¶é—´ï¼ˆé»˜è®¤8ç§’ï¼‰
  dayDiscussionSeconds: number;  // ç™½å¤©è®¨è®ºæ—¶é—´ï¼ˆé»˜è®¤180ç§’ï¼‰
  votingSeconds: number;         // æŠ•ç¥¨æ—¶é—´ï¼ˆé»˜è®¤30ç§’ï¼‰
}

// ===== å¤œæ™šé˜¶æ®µçŠ¶æ€ =====
interface NightState {
  currentDiceCall: number;    // å½“å‰å«åˆ°çš„ç‚¹æ•°ï¼ˆ1-6ï¼‰
  awakePlayerIds: string[];   // å½“å‰è½®æ¬¡é†’æ¥çš„ç©å®¶ ID åˆ—è¡¨
  actions: NightAction[];     // å·²æ‰§è¡Œçš„è¡ŒåŠ¨è®°å½•
}

// ===== å¤œæ™šè¡ŒåŠ¨è®°å½• =====
interface NightAction {
  playerId: string;           // æ‰§è¡Œè€…
  type: 'VIEW_DICE' | 'STEAL_CHEESE' | 'NONE';
  targetId?: string;          // æŸ¥çœ‹äº†è°çš„éª°å­
  viewedValue?: number;       // çœ‹åˆ°çš„ç‚¹æ•°å€¼
}

// ===== å…±çŠ¯é˜¶æ®µçŠ¶æ€ =====
interface AccompliceState {
  phase: 'THIEF_SELECT' | 'ACCOMPLICE_REVEAL' | 'DONE';
  selectedIds: string[];      // è¢«é€‰ä¸ºå…±çŠ¯çš„ç©å®¶ ID
}

// ===== æ¸¸æˆç»“æœ =====
interface GameResult {
  winner: Team;                  // è·èƒœæ–¹
  revealedPlayers: {             // è¢«ç¿»ç‰Œçš„ç©å®¶
    id: string;
    role: Role;
    isAccomplice: boolean;
  }[];
  allPlayers: {                  // æ‰€æœ‰ç©å®¶çš„çœŸå®ä¿¡æ¯ï¼ˆå¤ç›˜ç”¨ï¼‰
    id: string;
    name: string;
    role: Role;
    diceValue: number;
    isAccomplice: boolean;
  }[];
}
```

### 3.3 å®¢æˆ·ç«¯å¯è§æ€§æ§åˆ¶ï¼ˆé˜²ä½œå¼Šæ ¸å¿ƒï¼‰

**æœåŠ¡ç«¯æ˜¯å”¯ä¸€æƒå¨**ã€‚å®¢æˆ·ç«¯åªæ”¶åˆ°è‡ªå·±æœ‰æƒçœ‹åˆ°çš„ä¿¡æ¯ï¼š

| ä¿¡æ¯ | è°èƒ½çœ‹åˆ° | ä½•æ—¶å¯è§ |
|------|---------|---------|
| è‡ªå·±çš„èº«ä»½ | ä»…è‡ªå·± | å‘ç‰Œå |
| è‡ªå·±çš„éª°å­ç‚¹æ•° | ä»…è‡ªå·± | æ·éª°å |
| å…¶ä»–äººçš„éª°å­ç‚¹æ•° | æŸ¥çœ‹è€… | å¤œæ™šç‹¬è‡ªé†’æ¥ä¸”é€‰æ‹©æŸ¥çœ‹å |
| è°å’Œæˆ‘åŒæ—¶é†’æ¥ | åŒç‚¹æ•°çš„ç©å®¶ | å¤œæ™šå¯¹åº”è½®æ¬¡ |
| å¤§ç›—å·å¥¶é…ª | åŒæ—¶é†’æ¥çš„ç©å®¶ | å¤œæ™šå¯¹åº”è½®æ¬¡ |
| å…±çŠ¯èº«ä»½ | å–å†³äºäººæ•°è§„åˆ™ | å…±çŠ¯æŒ‡å®šé˜¶æ®µå |
| æ‰€æœ‰äººèº«ä»½å’Œéª°å­ | æ‰€æœ‰äºº | æ¸¸æˆç»“æŸç»“ç®—æ—¶ |

**å®ç°æ–¹å¼**ï¼šæœåŠ¡ç«¯å¯¹æ¯ä¸ªç©å®¶æ„å»º**ä¸ªæ€§åŒ–çš„çŠ¶æ€å¿«ç…§**ï¼ˆPlayerViewï¼‰ï¼ŒåªåŒ…å«è¯¥ç©å®¶æœ‰æƒçœ‹åˆ°çš„ä¿¡æ¯ï¼Œé€šè¿‡ Socket.IO çš„ `socket.emit`ï¼ˆå•å‘ï¼‰è€Œé `io.to(room).emit`ï¼ˆå¹¿æ’­ï¼‰ä¸‹å‘æ•æ„Ÿä¿¡æ¯ã€‚

```typescript
// æœåŠ¡ç«¯ä¸ºæ¯ä¸ªç©å®¶ç”Ÿæˆä¸ªæ€§åŒ–è§†å›¾
function buildPlayerView(room: GameRoom, playerId: string): ClientGameState {
  const player = room.players.find(p => p.id === playerId);
  return {
    phase: room.phase,
    players: room.players.map(p => ({
      id: p.id,
      name: p.name,
      avatarIndex: p.avatarIndex,
      isHost: p.isHost,
      isConnected: p.isConnected,
      hasVoted: p.hasVoted,
      voteCount: room.phase === 'RESULT' ? p.voteCount : undefined,
      // èº«ä»½ä¿¡æ¯ï¼šåªæœ‰è‡ªå·±çš„å¯è§ï¼Œç»“ç®—æ—¶å…¨éƒ¨å¯è§
      role: (p.id === playerId || room.phase === 'RESULT') ? p.role : null,
      // éª°å­ï¼šåªæœ‰è‡ªå·±çš„å’ŒæŸ¥çœ‹è¿‡çš„å¯è§
      diceValue: canSeeDice(playerId, p.id, room) ? p.diceValue : null,
    })),
    // ... å…¶ä»–é˜¶æ®µæ•°æ®
  };
}
```

---

## å››ã€Socket.IO é€šä¿¡åè®®

### 4.1 äº‹ä»¶å®šä¹‰

```typescript
// shared/events.ts

// ===== å®¢æˆ·ç«¯ â†’ æœåŠ¡ç«¯ =====
const ClientEvents = {
  // æˆ¿é—´
  CREATE_ROOM: 'room:create',         // åˆ›å»ºæˆ¿é—´
  JOIN_ROOM: 'room:join',             // åŠ å…¥æˆ¿é—´
  LEAVE_ROOM: 'room:leave',           // ç¦»å¼€æˆ¿é—´
  
  // æ¸¸æˆæ§åˆ¶
  START_GAME: 'game:start',           // æˆ¿ä¸»å¼€å§‹æ¸¸æˆ
  
  // å¤œæ™šè¡ŒåŠ¨
  NIGHT_VIEW_DICE: 'night:viewDice',  // è´ªç¡é¼ æŸ¥çœ‹éª°å­
  NIGHT_SKIP: 'night:skip',           // ä¸æ‰§è¡Œè¡ŒåŠ¨
  
  // å…±çŠ¯æŒ‡å®š
  SELECT_ACCOMPLICE: 'accomplice:select', // å¤§ç›—é€‰å…±çŠ¯
  
  // ç™½å¤©
  SEND_MESSAGE: 'day:message',        // å‘é€èŠå¤©æ¶ˆæ¯
  
  // æŠ•ç¥¨
  CAST_VOTE: 'vote:cast',            // æŠ•ç¥¨
  
  // è®¾ç½®
  UPDATE_SETTINGS: 'settings:update', // æ›´æ–°æ¸¸æˆè®¾ç½®
};

// ===== æœåŠ¡ç«¯ â†’ å®¢æˆ·ç«¯ =====
const ServerEvents = {
  // æˆ¿é—´
  ROOM_CREATED: 'room:created',       // æˆ¿é—´å·²åˆ›å»º
  ROOM_JOINED: 'room:joined',         // å·²åŠ å…¥æˆ¿é—´
  ROOM_UPDATED: 'room:updated',       // æˆ¿é—´çŠ¶æ€æ›´æ–°ï¼ˆå¹¿æ’­ï¼‰
  ROOM_ERROR: 'room:error',           // æˆ¿é—´é”™è¯¯
  
  // æ¸¸æˆçŠ¶æ€
  GAME_STATE: 'game:state',           // å®Œæ•´æ¸¸æˆçŠ¶æ€æ¨é€ï¼ˆä¸ªæ€§åŒ–ï¼‰
  PHASE_CHANGED: 'game:phaseChanged', // é˜¶æ®µå˜æ›´é€šçŸ¥
  
  // å¤œæ™š
  NIGHT_YOUR_TURN: 'night:yourTurn',  // è½®åˆ°ä½ è¡ŒåŠ¨
  NIGHT_AWAKE_INFO: 'night:awakeInfo',// å‘ŠçŸ¥è°å’Œä½ åŒæ—¶é†’æ¥
  NIGHT_DICE_RESULT: 'night:diceResult', // æŸ¥çœ‹éª°å­çš„ç»“æœ
  NIGHT_PROGRESS: 'night:progress',   // å¤œæ™šè¿›åº¦ï¼ˆå½“å‰å«åˆ°å‡ ç‚¹ï¼‰
  
  // å…±çŠ¯
  ACCOMPLICE_YOUR_TURN: 'accomplice:yourTurn',  // å¤§ç›—é€‰å…±çŠ¯
  ACCOMPLICE_REVEALED: 'accomplice:revealed',    // å…±çŠ¯ç›¸è®¤ä¿¡æ¯
  
  // ç™½å¤©
  NEW_MESSAGE: 'day:newMessage',      // æ–°èŠå¤©æ¶ˆæ¯
  
  // æŠ•ç¥¨
  VOTE_UPDATE: 'vote:update',         // æŠ•ç¥¨è¿›åº¦æ›´æ–°
  
  // ç»“æœ
  GAME_RESULT: 'game:result',         // æ¸¸æˆç»“æœ
  
  // ç³»ç»Ÿ
  PLAYER_DISCONNECTED: 'sys:disconnected', // ç©å®¶æ–­çº¿
  PLAYER_RECONNECTED: 'sys:reconnected',   // ç©å®¶é‡è¿
};
```

### 4.2 å…³é”®é€šä¿¡æµç¨‹

#### åˆ›å»º & åŠ å…¥æˆ¿é—´

```
Client A                    Server                    Client B
   |                          |                          |
   |-- CREATE_ROOM ---------->|                          |
   |<-- ROOM_CREATED --------|                          |
   |   {roomCode: "A3F7"}    |                          |
   |                          |                          |
   |                          |<-- JOIN_ROOM ------------|
   |                          |    {roomCode: "A3F7",    |
   |                          |     name: "å°æ˜"}        |
   |<-- ROOM_UPDATED --------|-- ROOM_JOINED ---------->|
   |   {players: [...]}      |   {roomCode, players}    |
```

#### å¤œæ™šé˜¶æ®µï¼ˆå…³é”®æµç¨‹ï¼‰

```
Server å†…éƒ¨æµç¨‹ï¼š
  for diceValue = 1 to 6:
    1. æ‰¾å‡ºéª°å­ç‚¹æ•° == diceValue çš„æ‰€æœ‰ç©å®¶
    2. å¹¿æ’­ NIGHT_PROGRESS {currentDice: diceValue} ç»™æ‰€æœ‰äººï¼ˆæ˜¾ç¤ºè¿›åº¦ï¼‰
    3. å¯¹é†’æ¥çš„ç©å®¶å•ç‹¬å‘ NIGHT_YOUR_TURN:
       - å‘ŠçŸ¥æœ‰å“ªäº›äººåŒæ—¶é†’æ¥ (awakePlayerIds)
       - å‘ŠçŸ¥ä½ çš„èº«ä»½ (role)
       - å‘ŠçŸ¥ä½ èƒ½åšä»€ä¹ˆ (availableActions)
    4. ç­‰å¾…è¡ŒåŠ¨ï¼ˆè¶…æ—¶è‡ªåŠ¨è·³è¿‡ï¼‰
    5. å¦‚æœè´ªç¡é¼ æŸ¥çœ‹éª°å­ â†’ å•å‘ NIGHT_DICE_RESULT
    6. å¦‚æœå¤§ç›—åœ¨æ­¤è½® â†’ æœåŠ¡ç«¯æ ‡è®°å¥¶é…ªå·²å·
    7. é€šçŸ¥é—­çœ¼ï¼Œè¿›å…¥ä¸‹ä¸€ç‚¹æ•°
```

---

## äº”ã€å‰ç«¯é¡µé¢ä¸ UI è®¾è®¡

### 5.1 é¡µé¢è·¯ç”±

| è·¯ç”± | é¡µé¢ | è¯´æ˜ |
|------|------|------|
| `/` | HomePage | é¦–é¡µï¼šè¾“å…¥æ˜µç§° â†’ åˆ›å»ºæˆ¿é—´ / åŠ å…¥æˆ¿é—´ |
| `/lobby/:roomCode` | LobbyPage | æˆ¿é—´å¤§å…ï¼šç­‰å¾…ç©å®¶åŠ å…¥ï¼Œæˆ¿ä¸»å¯è®¾ç½®å’Œå¼€å§‹ |
| `/game/:roomCode` | GamePage | æ¸¸æˆä¸»é¡µé¢ï¼šåŒ…å«æ‰€æœ‰æ¸¸æˆé˜¶æ®µçš„ UI |

### 5.2 é¦–é¡µè®¾è®¡ï¼ˆHomePageï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     [Safe Area Top]      â”‚
â”‚                          â”‚
â”‚     ğŸ§€ å¥¶é…ªå¤§ç›— ğŸ­       â”‚  â† æ ‡é¢˜ + Logo åŠ¨ç”»
â”‚     Cheese Thief         â”‚
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  è¾“å…¥ä½ çš„æ˜µç§°      â”‚    â”‚  â† shadcn Input
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   ğŸ  åˆ›å»ºæˆ¿é—´      â”‚    â”‚  â† shadcn Button (primary)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   ğŸšª åŠ å…¥æˆ¿é—´      â”‚    â”‚  â† shadcn Button (secondary)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â† å±•å¼€è¾“å…¥æˆ¿é—´ç 
â”‚  â”‚  æˆ¿é—´ç : [____]    â”‚    â”‚
â”‚  â”‚  [ç¡®è®¤åŠ å…¥]        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚
â”‚     [Safe Area Bottom]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 æˆ¿é—´å¤§å…è®¾è®¡ï¼ˆLobbyPageï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆ¿é—´: A3F7    [å¤åˆ¶é‚€è¯·]  â”‚  â† é¡¶éƒ¨ä¿¡æ¯æ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â”‚
â”‚  ğŸ‘¤ å°æ˜ (æˆ¿ä¸»)    âœ…     â”‚  â† å·²å‡†å¤‡æ ‡è®°
â”‚  ğŸ‘¤ å°çº¢           âœ…     â”‚
â”‚  ğŸ‘¤ å°å¼º           âœ…     â”‚
â”‚  ğŸ‘¤ ç­‰å¾…åŠ å…¥...           â”‚  â† ç©ºä½ï¼ˆç°è‰²è™šçº¿ï¼‰
â”‚  ğŸ‘¤ ç­‰å¾…åŠ å…¥...           â”‚
â”‚                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¸¸æˆè®¾ç½®ï¼ˆä»…æˆ¿ä¸»å¯æ”¹ï¼‰     â”‚
â”‚ è®¨è®ºæ—¶é—´: [3åˆ†é’Ÿ â–¼]       â”‚
â”‚ ä½¿ç”¨èƒŒé”…é¼ : [å¼€å…³]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   ğŸ® å¼€å§‹æ¸¸æˆ      â”‚    â”‚  â† ä»…æˆ¿ä¸»å¯è§ï¼Œäººæ•°â‰¥4æ—¶å¯ç‚¹å‡»
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 æ¸¸æˆä¸»é¡µé¢è®¾è®¡ï¼ˆGamePageï¼‰

æ¸¸æˆé¡µé¢æ ¹æ®ä¸åŒé˜¶æ®µåˆ‡æ¢å†…å®¹ï¼š

#### 5.4.1 å‘ç‰Œé˜¶æ®µï¼ˆDEALINGï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚    ğŸ´ èº«ä»½åˆ†é…ä¸­...       â”‚
â”‚                          â”‚
â”‚    [å¡ç‰Œç¿»è½¬åŠ¨ç”»]         â”‚  â† Motion 3D ç¿»è½¬
â”‚    ä½ çš„èº«ä»½æ˜¯:            â”‚
â”‚    âœ¨ è´ªç¡é¼  âœ¨           â”‚
â”‚                          â”‚
â”‚    ğŸ² æ·éª°å­...          â”‚
â”‚    [éª°å­æ»šåŠ¨åŠ¨ç”»]         â”‚
â”‚    ä½ çš„ç‚¹æ•°: 3            â”‚
â”‚                          â”‚
â”‚    è®°ä½åç‚¹å‡»ç»§ç»­          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     æˆ‘è®°ä½äº†       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.4.2 å¤œæ™šé˜¶æ®µï¼ˆNIGHTï¼‰

**éè¡ŒåŠ¨ç©å®¶è§†è§’ï¼ˆé—­çœ¼çŠ¶æ€ï¼‰**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚    ğŸŒ™ å¤œæ™šé™ä¸´...         â”‚  â† æ·±è‰²èƒŒæ™¯ + æ˜Ÿç©ºç²’å­
â”‚                          â”‚
â”‚    å½“å‰: éª°åˆ° 3 çš„        â”‚
â”‚    ç©å®¶è¯·ççœ¼             â”‚
â”‚                          â”‚
â”‚    â±ï¸ 0:05               â”‚  â† å€’è®¡æ—¶
â”‚                          â”‚
â”‚    è¯·å®‰é™ç­‰å¾…...           â”‚
â”‚                          â”‚
â”‚    â— â— â— â—‹ â—‹ â—‹          â”‚  â† è¿›åº¦æŒ‡ç¤ºå™¨ï¼ˆ1-6ï¼‰
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¡ŒåŠ¨ç©å®¶è§†è§’ï¼ˆççœ¼çŠ¶æ€ - è´ªç¡é¼ ç‹¬è‡ªé†’æ¥ï¼‰**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚    ğŸ‘ï¸ ä½ çå¼€äº†çœ¼ç›        â”‚
â”‚    åªæœ‰ä½ ä¸€ä¸ªäººé†’æ¥        â”‚
â”‚                          â”‚
â”‚    ä½ å¯ä»¥æŸ¥çœ‹ä¸€ä¸ªäººçš„éª°å­   â”‚
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ å°çº¢  â”‚ â”‚ å°å¼º  â”‚      â”‚  â† å¯é€‰æ‹©çš„ç©å®¶ï¼ˆéª°ç›…å›¾æ ‡ï¼‰
â”‚  â”‚ [ğŸ¥›] â”‚ â”‚ [ğŸ¥›] â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ å¤§å£®  â”‚ â”‚ é˜¿èŠ±  â”‚      â”‚
â”‚  â”‚ [ğŸ¥›] â”‚ â”‚ [ğŸ¥›] â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                          â”‚
â”‚    [è·³è¿‡ï¼Œä¸æŸ¥çœ‹]          â”‚
â”‚                          â”‚
â”‚    â±ï¸ 0:05               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¡ŒåŠ¨ç©å®¶è§†è§’ï¼ˆæœ‰äººåŒæ—¶é†’æ¥ï¼‰**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚    ğŸ‘ï¸ ä½ çå¼€äº†çœ¼ç›        â”‚
â”‚                          â”‚
â”‚    âš ï¸ æœ‰å…¶ä»–ç©å®¶ä¹Ÿé†’ç€:   â”‚
â”‚    ğŸ‘¤ å°çº¢                â”‚
â”‚                          â”‚
â”‚    æœ‰äººåŒæ—¶é†’æ¥ï¼Œ          â”‚
â”‚    ä½ ä»€ä¹ˆéƒ½ä¸èƒ½åšã€‚         â”‚
â”‚    è®°ä½è°å’Œä½ åŒæ—¶é†’æ¥ã€‚     â”‚
â”‚                          â”‚
â”‚    â±ï¸ 0:05               â”‚
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¥¶é…ªå¤§ç›—è§†è§’**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚    ğŸ‘ï¸ ä½ çå¼€äº†çœ¼ç›        â”‚
â”‚    ä½ æ˜¯ ğŸ§€ å¥¶é…ªå¤§ç›—ï¼      â”‚
â”‚                          â”‚
â”‚    å·èµ°å¥¶é…ªï¼              â”‚
â”‚    [å¥¶é…ªæŠ“å–åŠ¨ç”»]          â”‚  â† æ‰‹æŒ‡æ»‘åŠ¨æ‹¿èµ°å¥¶é…ª
â”‚                          â”‚
â”‚    (æœ‰äººä¹Ÿé†’ç€: å°çº¢)      â”‚  â† å¦‚æœæœ‰äººåŒé†’
â”‚    âš ï¸ å°çº¢çœ‹åˆ°äº†ä½ ï¼       â”‚
â”‚                          â”‚
â”‚    â±ï¸ 0:05               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.4.3 å…±çŠ¯æŒ‡å®šé˜¶æ®µï¼ˆACCOMPLICEï¼‰

**å¥¶é…ªå¤§ç›—è§†è§’ï¼ˆé€‰æ‹©å…±çŠ¯ï¼‰**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚    ğŸ¤ é€‰æ‹©ä½ çš„å…±çŠ¯         â”‚
â”‚    ç‚¹å‡»é€‰æ‹© 1 åç©å®¶       â”‚  â† 6äººå±€é€‰1äººï¼Œ7-8äººé€‰2äºº
â”‚                          â”‚
â”‚  [å°çº¢] [å°å¼º] [å¤§å£®]     â”‚
â”‚         [é˜¿èŠ±] [å°åˆš]     â”‚  â† å¯é€‰ç©å®¶å¤´åƒ
â”‚                          â”‚
â”‚    å·²é€‰: å°çº¢ âœ…           â”‚
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     ç¡®è®¤é€‰æ‹©       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚
â”‚    â±ï¸ 0:08               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¢«é€‰ä¸ºå…±çŠ¯çš„ç©å®¶è§†è§’ï¼ˆç›¸è®¤ï¼‰**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚    âš ï¸ ä½ è¢«é€‰ä¸ºå…±çŠ¯äº†ï¼     â”‚
â”‚                          â”‚
â”‚    å¥¶é…ªå¤§ç›—æ˜¯: å°æ˜        â”‚  â† 6äºº/8äººå±€å¯è§
â”‚    (7äººå±€: å¦ä¸€ä½å…±çŠ¯æ˜¯    â”‚  â† 7äººå±€åªçœ‹åˆ°å…±çŠ¯
â”‚     å°å¼ºï¼Œå¤§ç›—èº«ä»½æœªçŸ¥)     â”‚
â”‚                          â”‚
â”‚    ä½ ç°åœ¨å±äºå¤§ç›—é˜µè¥ï¼Œ     â”‚
â”‚    å¸®åŠ©å¤§ç›—ä¸è¢«æ‰¾å‡ºæ¥ï¼     â”‚
â”‚                          â”‚
â”‚    â±ï¸ 0:05               â”‚
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.4.4 ç™½å¤©è®¨è®ºé˜¶æ®µï¼ˆDAYï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜€ï¸ ç™½å¤©è®¨è®º  â±ï¸ 2:35      â”‚  â† é¡¶éƒ¨å€’è®¡æ—¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â”‚
â”‚  ğŸ”” å¥¶é…ªè¢«å·äº†ï¼          â”‚
â”‚  è¯·è®¨è®ºæ‰¾å‡ºå¥¶é…ªå¤§ç›—        â”‚
â”‚                          â”‚
â”‚  å°æ˜: æˆ‘æ˜¯3ç‚¹é†’æ¥çš„ï¼Œ     â”‚
â”‚       åªæœ‰æˆ‘ä¸€ä¸ªäºº         â”‚
â”‚                          â”‚
â”‚  å°çº¢: æˆ‘ä¹Ÿæ˜¯3ç‚¹ï¼Œ         â”‚
â”‚       æˆ‘çœ‹åˆ°å°æ˜äº†         â”‚
â”‚                          â”‚
â”‚  å°å¼º: æˆ‘ç‹¬è‡ªé†’æ¥ï¼ŒæŸ¥äº†    â”‚
â”‚       å°æ˜çš„éª°å­æ˜¯3ç‚¹      â”‚
â”‚                          â”‚
â”‚  å¤§å£®: å—¯...æˆ‘æ˜¯5ç‚¹       â”‚
â”‚       æ²¡çœ‹åˆ°åˆ«äºº           â”‚
â”‚                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” [å‘é€] â”‚  â† åº•éƒ¨è¾“å…¥æ¡†
â”‚ â”‚  è¾“å…¥æ¶ˆæ¯...     â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚     [Safe Area Bottom]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.4.5 æŠ•ç¥¨é˜¶æ®µï¼ˆVOTINGï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—³ï¸ æŠ•ç¥¨é˜¶æ®µ  â±ï¸ 0:25     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â”‚
â”‚  è¯·æŠ•å‡ºä½ è®¤ä¸ºçš„å¥¶é…ªå¤§ç›—    â”‚
â”‚  ç‚¹å‡»ä¸€ä½ç©å®¶æŠ•ç¥¨          â”‚
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ‘¤ å°æ˜           â”‚    â”‚  â† é€‰ä¸­é«˜äº®
â”‚  â”‚ ğŸ‘¤ å°çº¢     â† ä½   â”‚    â”‚  â† è‡ªå·±ä¸å¯é€‰
â”‚  â”‚ ğŸ‘¤ å°å¼º           â”‚    â”‚
â”‚  â”‚ ğŸ‘¤ å¤§å£®    âœ…     â”‚    â”‚  â† é€‰ä¸­æ ‡è®°
â”‚  â”‚ ğŸ‘¤ é˜¿èŠ±           â”‚    â”‚
â”‚  â”‚ ğŸ‘¤ å°åˆš           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚
â”‚  å·²æŠ•ç¥¨: 4/6             â”‚  â† è¿›åº¦æç¤º
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     ç¡®è®¤æŠ•ç¥¨       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.4.6 ç»“ç®—é˜¶æ®µï¼ˆRESULTï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚    ğŸ‰ æ¸¸æˆç»“æŸï¼          â”‚
â”‚                          â”‚
â”‚    æŠ•ç¥¨ç»“æœ:              â”‚
â”‚    å¤§å£®: 3ç¥¨ â¬†ï¸ æœ€é«˜ç¥¨    â”‚
â”‚    å°æ˜: 2ç¥¨              â”‚
â”‚    å°å¼º: 1ç¥¨              â”‚
â”‚                          â”‚
â”‚    ç¿»ç‰Œ: å¤§å£® â†’ è´ªç¡é¼    â”‚  â† ç¿»ç‰ŒåŠ¨ç”»
â”‚                          â”‚
â”‚    ğŸ† å¥¶é…ªå¤§ç›—é˜µè¥è·èƒœï¼   â”‚
â”‚                          â”‚
â”‚    â”€â”€â”€ çœŸç›¸æ­æ™“ â”€â”€â”€      â”‚
â”‚    å°æ˜: è´ªç¡é¼  ğŸ²3       â”‚
â”‚    å°çº¢: è´ªç¡é¼  ğŸ²3       â”‚  â† å…¨éƒ¨ä¿¡æ¯å…¬å¼€
â”‚    å°å¼º: è´ªç¡é¼  ğŸ²1       â”‚
â”‚    å¤§å£®: å…±çŠ¯   ğŸ²5       â”‚
â”‚    é˜¿èŠ±: å¥¶é…ªå¤§ç›— ğŸ²4 ğŸ§€  â”‚  â† å¤§ç›—é«˜äº®
â”‚    å°åˆš: è´ªç¡é¼  ğŸ²6       â”‚
â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   è¿”å›å¤§å…å†æ¥ä¸€å±€  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å…­ã€è§†è§‰é£æ ¼å®šä¹‰

### 6.1 è‰²å½©æ–¹æ¡ˆ

æ¸¸æˆä¸»é¢˜ï¼š**æ¸©æš–çš„æ£•è‰²è°ƒ + å¥¶é…ªé»„**ï¼Œå‘ˆç°é¼ æ´/æœ¨å±‹çš„æ°›å›´ã€‚

TailwindCSS v4 ä½¿ç”¨ `@theme` æŒ‡ä»¤å®šä¹‰è‡ªå®šä¹‰é¢œè‰²ï¼Œå¯ç›´æ¥åœ¨ `globals.css` ä¸­é…ç½®ï¼š

```css
/* globals.css */
@import "tailwindcss";

@theme {
  /* ä¸»è‰²è°ƒ - å¥¶é…ªé»„ */
  --color-cheese-50: #FFFBEB;
  --color-cheese-100: #FEF3C7;
  --color-cheese-200: #FDE68A;
  --color-cheese-300: #FCD34D;
  --color-cheese-400: #FBBF24;   /* ä¸»è‰² */
  --color-cheese-500: #F59E0B;

  /* èƒŒæ™¯è‰² - æ£•è‰²æœ¨çº¹ */
  --color-wood-700: #78350F;
  --color-wood-800: #5C2D0E;
  --color-wood-900: #451A03;      /* ä¸»èƒŒæ™¯ */
  --color-wood-950: #2D1106;

  /* å¤œæ™š - æ·±è“ç´« */
  --color-night-800: #1E1B4B;
  --color-night-900: #0F0B2E;

  /* åŠŸèƒ½è‰² */
  --color-good: #22C55E;          /* å¥½äººé˜µè¥ - ç»¿ */
  --color-evil: #EF4444;          /* åäººé˜µè¥ - çº¢ */
  --color-neutral: #A855F7;       /* èƒŒé”…é¼  - ç´« */
}
```

> TailwindCSS v4 çš„é¢œè‰²å‘½åç©ºé—´ä¸º `--color-*`ï¼Œå®šä¹‰åå¯ç›´æ¥åœ¨ç±»åä¸­ä½¿ç”¨ï¼Œå¦‚ `bg-cheese-400`ã€`text-wood-900`ã€‚

### 6.2 å­—ä½“

```css
font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Helvetica Neue', sans-serif;
```

ä½¿ç”¨ iOS ç³»ç»Ÿå­—ä½“ï¼Œæ— éœ€åŠ è½½é¢å¤–å­—ä½“æ–‡ä»¶ï¼Œç¡®ä¿æœ€å¿«æ¸²æŸ“ã€‚

### 6.3 åŠ¨ç”»è§„èŒƒ

| åŠ¨ç”» | æŠ€æœ¯ | æ—¶é•¿ | ç¼“åŠ¨ |
|------|------|------|------|
| å¡ç‰Œç¿»è½¬ | Motion `rotateY` | 600ms | `easeInOut` |
| éª°å­æ»šåŠ¨ | CSS `@keyframes` + `transform` | 800ms | `cubic-bezier(0.25, 0.46, 0.45, 0.94)` |
| å¤œæ™šæ¸å…¥ | Motion `opacity` + `scale` | 400ms | `easeOut` |
| æŠ•ç¥¨æŒ‡å‘ | Motion `layoutId` | 300ms | `spring` |
| é¡µé¢åˆ‡æ¢ | Motion `AnimatePresence` | 300ms | `easeInOut` |
| å¥¶é…ªæ¶ˆå¤± | Motion `scale` â†’ 0 + `opacity` â†’ 0 | 500ms | `anticipate` |
| ç»“æœçƒŸèŠ± | CSS `@keyframes` ç²’å­ | 2000ms | `ease-out` |

> æ³¨æ„ï¼šFramer Motion å·²æ”¹åä¸º Motionã€‚npm åŒ…åä¸º `motion`ï¼Œimport ä» `"motion/react"` å¼•å…¥ã€‚

---

## ä¸ƒã€åç«¯æ¸¸æˆå¼•æ“è¯¦ç»†é€»è¾‘

### 7.1 GameEngine æ ¸å¿ƒæ–¹æ³•

```typescript
class GameEngine {
  // ===== æ¸¸æˆåˆå§‹åŒ– =====
  startGame(room: GameRoom): void
  // 1. éªŒè¯äººæ•°ï¼ˆ4-8ï¼‰
  // 2. åˆ†é…èº«ä»½ï¼ˆæ´—ç‰Œ â†’ å‘ç‰Œï¼‰
  // 3. ä¸ºæ¯ä¸ªç©å®¶æ·éª°å­ï¼ˆéšæœº 1-6ï¼‰
  // 4. 4äººå±€ï¼šæ¯äººæ·2é¢—
  // 5. åˆå§‹åŒ– nightState
  // 6. æ¨é€ DEALING é˜¶æ®µ â†’ ç­‰å¾…æ‰€æœ‰äººç¡®è®¤ â†’ è¿›å…¥ NIGHT

  // ===== å¤œæ™šé˜¶æ®µ =====
  async runNightPhase(room: GameRoom): Promise<void>
  // for (let dice = 1; dice <= 6; dice++):
  //   1. æ‰¾å‡ºè¯¥ç‚¹æ•°çš„ç©å®¶åˆ—è¡¨ awakePlayers
  //   2. å¹¿æ’­ NIGHT_PROGRESS
  //   3. å¦‚æœ awakePlayers.length == 0 â†’ ç­‰å¾…å›ºå®šæ—¶é—´ â†’ ä¸‹ä¸€è½®
  //   4. å¯¹æ¯ä¸ªé†’æ¥çš„ç©å®¶å‘ NIGHT_YOUR_TURN
  //   5. åˆ¤æ–­è¡ŒåŠ¨è§„åˆ™å¹¶ç­‰å¾…ç©å®¶æ“ä½œ
  //   6. è¶…æ—¶è‡ªåŠ¨è·³è¿‡
  // è¿›å…¥ ACCOMPLICE é˜¶æ®µï¼ˆ5-8äººï¼‰æˆ– DAY é˜¶æ®µï¼ˆ4äººï¼‰

  // ===== å¤œæ™šè¡ŒåŠ¨å¤„ç† =====
  handleNightAction(room: GameRoom, playerId: string, action: NightActionInput): void
  // - VIEW_DICE: éªŒè¯æ˜¯å¦åªæœ‰è‡ªå·±é†’æ¥ + é4äººå±€è´ªç¡é¼  â†’ è¿”å›ç›®æ ‡éª°å­å€¼
  // - STEAL_CHEESE: æ ‡è®° cheeseStolen = true
  // - SKIP: ä¸æ‰§è¡Œä»»ä½•æ“ä½œ

  // ===== å…±çŠ¯é˜¶æ®µ =====
  async runAccomplicePhase(room: GameRoom): Promise<void>
  // æ ¹æ®äººæ•°è§„åˆ™æ‰§è¡Œä¸åŒé€»è¾‘
  // 5äºº: æ£€æŸ¥å¤œæ™šæ˜¯å¦å·²è‡ªç„¶äº§ç”Ÿå…±çŠ¯
  // 6äºº: å¤§ç›—é€‰1äººï¼ŒåŒæ–¹ç›¸è®¤
  // 7äºº: å¤§ç›—é€‰2äººï¼Œå¤§ç›—å…ˆé—­çœ¼ï¼Œå…±çŠ¯äº’è®¤
  // 8äºº: å¤§ç›—é€‰2äººï¼Œä¸‰æ–¹ç›¸è®¤

  // ===== ç™½å¤©é˜¶æ®µ =====
  startDayPhase(room: GameRoom): void
  // å¼€å§‹å€’è®¡æ—¶ â†’ åˆ°æ—¶é—´æˆ–æˆ¿ä¸»æå‰ç»“æŸ â†’ è¿›å…¥ VOTING

  // ===== æŠ•ç¥¨é˜¶æ®µ =====
  handleVote(room: GameRoom, playerId: string, targetId: string): void
  // è®°å½•æŠ•ç¥¨ â†’ æ£€æŸ¥æ˜¯å¦æ‰€æœ‰äººå·²æŠ• â†’ å…¨æŠ•å®Œåˆ™ç»“ç®—

  // ===== ç»“ç®— =====
  calculateResult(room: GameRoom): GameResult
  // 1. ç»Ÿè®¡ç¥¨æ•°ï¼Œæ‰¾å‡ºæœ€é«˜ç¥¨ç©å®¶
  // 2. å¤„ç†å¹³ç¥¨ï¼ˆå¤šäººç¿»ç‰Œï¼‰
  // 3. åˆ¤æ–­èƒœè´Ÿï¼š
  //    - èƒŒé”…é¼ åœ¨æœ€é«˜ç¥¨ä¸­ â†’ èƒŒé”…é¼ ç‹¬è‡ªèƒœ
  //    - å¤§ç›—åœ¨æœ€é«˜ç¥¨ä¸­ â†’ è´ªç¡é¼ èƒœ
  //    - å¤§ç›—ä¸åœ¨æœ€é«˜ç¥¨ä¸­ â†’ å¤§ç›—+å…±çŠ¯èƒœ
  // 4. ç”Ÿæˆå®Œæ•´ç»“æœï¼ˆå«æ‰€æœ‰äººçœŸå®ä¿¡æ¯ç”¨äºå¤ç›˜ï¼‰
}
```

### 7.2 æ–­çº¿é‡è¿é€»è¾‘

```typescript
// Socket.IO è‡ªå¸¦ reconnectï¼Œé…åˆä»¥ä¸‹é€»è¾‘ï¼š

// æœåŠ¡ç«¯ï¼š
socket.on('disconnect', () => {
  // ä¸ç«‹å³ç§»é™¤ç©å®¶ï¼Œæ ‡è®° isConnected = false
  // è®¾ç½® 60 ç§’è¶…æ—¶ï¼Œè¶…æ—¶åè§†ä¸ºé€€å‡º
  player.isConnected = false;
  player.disconnectTimer = setTimeout(() => {
    removePlayer(room, player.id);
  }, 60000);
});

socket.on('reconnect:attempt', ({ roomCode, playerId }) => {
  // ç”¨ playerIdï¼ˆå­˜åœ¨å®¢æˆ·ç«¯ localStorageï¼‰åŒ¹é…å›åŸç©å®¶
  // æ¢å¤è¿æ¥ï¼Œæ¨é€å®Œæ•´å½“å‰çŠ¶æ€
  clearTimeout(player.disconnectTimer);
  player.isConnected = true;
  player.socketId = socket.id;
  sendFullState(socket, room, player.id);
});
```

---

## å…«ã€å¼€å‘è®¡åˆ’ä¸é‡Œç¨‹ç¢‘

### Phase 1ï¼šé¡¹ç›®éª¨æ¶ï¼ˆç¬¬ 1 å¤©ï¼‰

- [ ] åˆå§‹åŒ–å‰ç«¯é¡¹ç›®ï¼šVite + React + TypeScript + TailwindCSS + shadcn/ui
- [ ] åˆå§‹åŒ–åç«¯é¡¹ç›®ï¼šNode.js + Express + Socket.IO + TypeScript
- [ ] åˆ›å»ºå…±äº«ç±»å‹å®šä¹‰ï¼ˆshared/types.ts, events.ts, constants.tsï¼‰
- [ ] æ­å»º MobileContainer + SafeAreaWrapper + å“åº”å¼åŸºç¡€
- [ ] PWA é…ç½®ï¼ˆmanifest.json, service workerï¼‰
- [ ] åŸºç¡€è·¯ç”±ï¼ˆé¦–é¡µ â†’ å¤§å… â†’ æ¸¸æˆï¼‰

### Phase 2ï¼šæˆ¿é—´ç³»ç»Ÿï¼ˆç¬¬ 2 å¤©ï¼‰

- [ ] åç«¯ï¼šRoomManager + GameRoom ç±»
- [ ] åç«¯ï¼šåˆ›å»ºæˆ¿é—´ã€åŠ å…¥æˆ¿é—´ã€ç¦»å¼€æˆ¿é—´ Socket äº‹ä»¶
- [ ] å‰ç«¯ï¼šé¦–é¡µ UIï¼ˆæ˜µç§°è¾“å…¥ã€åˆ›å»º/åŠ å…¥æˆ¿é—´ï¼‰
- [ ] å‰ç«¯ï¼šæˆ¿é—´å¤§å… UIï¼ˆç©å®¶åˆ—è¡¨ã€è®¾ç½®ã€å¼€å§‹æŒ‰é’®ï¼‰
- [ ] æˆ¿é—´ç ç”Ÿæˆä¸éªŒè¯
- [ ] æ–­çº¿é‡è¿åŸºç¡€

### Phase 3ï¼šæ¸¸æˆæ ¸å¿ƒ - å‘ç‰Œä¸å¤œæ™šï¼ˆç¬¬ 3-4 å¤©ï¼‰

- [ ] åç«¯ï¼šGameEngine æ ¸å¿ƒçŠ¶æ€æœº
- [ ] åç«¯ï¼šå‘ç‰Œé€»è¾‘ï¼ˆèº«ä»½åˆ†é… + æ·éª°ï¼‰
- [ ] åç«¯ï¼šå¤œæ™šé˜¶æ®µå®Œæ•´é€»è¾‘ï¼ˆ1-6 ç‚¹æ•°è½®æ¬¡ã€è¡ŒåŠ¨åˆ¤å®šï¼‰
- [ ] å‰ç«¯ï¼šå‘ç‰ŒåŠ¨ç”»ï¼ˆå¡ç‰Œç¿»è½¬ + éª°å­æ»šåŠ¨ï¼‰
- [ ] å‰ç«¯ï¼šå¤œæ™š UIï¼ˆé—­çœ¼ç­‰å¾…ã€ççœ¼è¡ŒåŠ¨ã€æŸ¥çœ‹éª°å­ã€å·å¥¶é…ªï¼‰
- [ ] å‰ç«¯ï¼šå¤œæ™šè¿›åº¦æŒ‡ç¤ºå™¨

### Phase 4ï¼šå…±çŠ¯ + ç™½å¤© + æŠ•ç¥¨ï¼ˆç¬¬ 5-6 å¤©ï¼‰

- [ ] åç«¯ï¼šå…±çŠ¯é˜¶æ®µé€»è¾‘ï¼ˆ5-8 äººå„è‡ªè§„åˆ™ï¼‰
- [ ] åç«¯ï¼šç™½å¤©è®¨è®ºï¼ˆèŠå¤©æ¶ˆæ¯è½¬å‘ + è®¡æ—¶å™¨ï¼‰
- [ ] åç«¯ï¼šæŠ•ç¥¨é€»è¾‘ï¼ˆæ”¶é›†ã€ç»Ÿè®¡ã€å¹³ç¥¨å¤„ç†ï¼‰
- [ ] åç«¯ï¼šç»“ç®—é€»è¾‘ï¼ˆèƒœè´Ÿåˆ¤å®šï¼Œå«èƒŒé”…é¼ ï¼‰
- [ ] å‰ç«¯ï¼šå…±çŠ¯æŒ‡å®š/ç›¸è®¤ UI
- [ ] å‰ç«¯ï¼šèŠå¤©é¢æ¿ UI
- [ ] å‰ç«¯ï¼šæŠ•ç¥¨é¢æ¿ UI
- [ ] å‰ç«¯ï¼šç»“ç®—ç”»é¢ UI + å¤ç›˜ä¿¡æ¯

### Phase 5ï¼š4 äººç‰¹æ®Šè§„åˆ™ + èƒŒé”…é¼ ï¼ˆç¬¬ 7 å¤©ï¼‰

- [ ] åç«¯ï¼š4 äººåŒéª°è§„åˆ™
- [ ] åç«¯ï¼šèƒŒé”…é¼ èƒœåˆ©åˆ¤å®š
- [ ] å‰ç«¯ï¼š4 äººåŒéª°é€‰æ‹© UI
- [ ] å‰ç«¯ï¼šèƒŒé”…é¼ ç›¸å…³ UI
- [ ] å„äººæ•°å…¨æµç¨‹è”è°ƒæµ‹è¯•

### Phase 6ï¼šæ‰“ç£¨ä¸éƒ¨ç½²ï¼ˆç¬¬ 8-9 å¤©ï¼‰

- [ ] åŠ¨ç”»æ‰“ç£¨ï¼ˆMotion å„å¤„ç»†èŠ‚ï¼‰
- [ ] éŸ³æ•ˆï¼ˆå¯é€‰ï¼šBGMã€éª°å­å£°ã€æŠ•ç¥¨å£°ï¼‰
- [ ] iOS å„æœºå‹å®é™…æµ‹è¯•
- [ ] æ–­çº¿é‡è¿å…¨æµç¨‹æµ‹è¯•
- [ ] Bug ä¿®å¤
- [ ] æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- [ ] éƒ¨ç½²åˆ°è‡ªæœ‰æœåŠ¡å™¨

### æ€»è®¡ï¼šçº¦ 9 ä¸ªå·¥ä½œæ—¥ï¼ˆ1 äººå¼€å‘ï¼‰

---

## ä¹ã€éƒ¨ç½²æ–¹æ¡ˆï¼ˆè‡ªæœ‰æœåŠ¡å™¨ï¼‰

### 9.1 ç”Ÿäº§æ„å»º

```bash
# å‰ç«¯æ„å»º
cd client
npm run build   # è¾“å‡ºåˆ° client/dist/

# åç«¯æ„å»º
cd server
npm run build   # TypeScript ç¼–è¯‘åˆ° server/dist/
```

### 9.2 æœåŠ¡å™¨éƒ¨ç½²ç»“æ„

```
/opt/cheese-thief/
â”œâ”€â”€ client/dist/         # å‰ç«¯é™æ€æ–‡ä»¶
â”œâ”€â”€ server/dist/         # åç«¯ç¼–è¯‘åçš„ JS
â”œâ”€â”€ server/node_modules/ # åç«¯ä¾èµ–
â”œâ”€â”€ server/package.json
â””â”€â”€ ecosystem.config.js  # PM2 é…ç½®ï¼ˆå¯é€‰ï¼‰
```

### 9.3 Nginx é…ç½®

```nginx
server {
    listen 80;
    server_name your-domain.com;  # æˆ– IP

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /opt/cheese-thief/client/dist;
        index index.html;
        try_files $uri $uri/ /index.html;  # SPA è·¯ç”±å›é€€
    }

    # Socket.IO åç«¯ä»£ç†
    location /socket.io/ {
        proxy_pass http://127.0.0.1:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 9.4 åç«¯å¯åŠ¨ï¼ˆPM2ï¼‰

```bash
pm2 start /opt/cheese-thief/server/dist/index.js --name cheese-thief-server
```

---

## åã€å®‰å…¨ä¸é˜²ä½œå¼Š

| é£é™© | é˜²æŠ¤æªæ–½ |
|------|---------|
| å®¢æˆ·ç«¯ç¯¡æ”¹èº«ä»½ | èº«ä»½/éª°å­/è¡ŒåŠ¨å…¨éƒ¨åœ¨æœåŠ¡ç«¯è®¡ç®—ï¼Œå®¢æˆ·ç«¯ä»…æ¥æ”¶è‡ªå·±å¯è§çš„ä¿¡æ¯ |
| çª¥æ¢ä»–äººéª°å­ | éª°å­ç‚¹æ•°æŒ‰éœ€å•å‘ï¼Œä¸å¹¿æ’­ |
| å¤œæ™šå·çœ‹ | éè¡ŒåŠ¨ç©å®¶åªæ”¶åˆ°"ç­‰å¾…ä¸­"çŠ¶æ€ï¼Œæ— ä»»ä½•æ•æ„Ÿæ•°æ® |
| é‡å¤æŠ•ç¥¨ | æœåŠ¡ç«¯æ ¡éªŒ hasVoted çŠ¶æ€ |
| ä¼ªé€ æˆ¿é—´ç  | æœåŠ¡ç«¯éªŒè¯æˆ¿é—´å­˜åœ¨æ€§å’Œç©å®¶èº«ä»½ |
| Socket åŠ«æŒ | ä½¿ç”¨ HTTPS + WSSï¼ˆéƒ¨ç½²æ—¶é…ç½® SSLï¼‰ |

---

*æœ¬è®¾è®¡æ–‡æ¡£æ¶µç›–äº†ã€Šå¥¶é…ªå¤§ç›—ã€‹åœ¨çº¿è”æœºæ¡Œæ¸¸çš„å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆã€‚æŒ‰æ­¤æ–‡æ¡£æ‰§è¡Œå¼€å‘ï¼Œå¯ä¿è¯æ¸¸æˆåŠŸèƒ½å®Œæ•´ã€iOS é€‚é…æ— æ­»è§’ã€è”æœºä½“éªŒæµç•…ã€‚*
